<!DOCTYPE html>
<html>
<body>

<h1>WebSocket Demo</h1>

<button type="button" onclick="sendMessage()">Send Message</button>
<button type="button" onclick="closeConnection()">Close Connection</button>

<script>
    var ws;
    function connectWebSocket() {
        var params = new URLSearchParams(window.location.search);
        var userId = params.get('userId');
        ws = new WebSocket('ws://localhost:8080/websocket/echo?userId=' + userId);

        ws.onopen = function (event) {
            console.log('Connection is open ...');
        };

        ws.onerror = function (err) {
            console.error('WebSocket encountered error: ', err.message, 'Closing socket');
            ws.close();
        };

        ws.onmessage = function (event) {
            console.log(event.data);
        };
    }

    function sendMessage() {
        if (ws) {
            ws.send("msg");
        } else {
            console.error('WebSocket connection is not established');
        }
    }

    function closeConnection() {
        if (ws) {
            ws.close();
        } else {
            console.error('WebSocket connection is not established');
        }
    }

    connectWebSocket();

</script>

</body>
</html>